{% extends "base.html" }}

{% block title %}ğŸ½ï¸ What's Your Dining Personality? - Quiz{% endblock %}

{% block content %}
<!-- Hero -->
<section class="quiz-hero" style="background: transparent; padding: 60px 0; text-align: center;">
    <div class="container">
        <h1 class="display-4 fw-bold mb-3">ğŸ­ What's Your Dining Personality?</h1>
        <p class="lead">Take this fun quiz to discover your restaurant matching type</p>
    </div>
</section>

<!-- Quiz Form -->
<section>
    <div class="container">
        <div class="quiz-card" style="background: white; border-radius: 20px; padding: 50px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
            <form id="personalityQuiz">
                <!-- Progress Dots -->
                <div class="progress-dots" style="display: flex; justify-content: center; gap: 10px; margin-bottom: 40px;">
                    {% for i in range(1, 8) %}
                    <div class="progress-dot" id="dot{{ i }}" style="width: 12px; height: 12px; border-radius: 50%; background: #e9ecef; transition: all 0.3s;"></div>
                    {% endfor %}
                </div>
                
                <!-- Question 1 -->
                <div class="question active" data-step="1">
                    <h4 class="mb-4 text-center">1. When choosing a restaurant, you mostly care about...</h4>
                    <div class="d-flex flex-column gap-3">
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(1, 'explorer')">
                            <strong>ğŸŒ</strong> Trying new and unique cuisines I've never had
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(1, 'comfort')">
                            <strong>ğŸœ</strong> Finding reliable favorites I know I'll enjoy
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(1, 'social')">
                            <strong>ğŸ‘¥</strong> The atmosphere and who I'm dining with
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(1, 'value')">
                            <strong>ğŸ’</strong> Getting the best value for my money
                        </button>
                    </div>
                </div>
                
                <!-- Question 2 -->
                <div class="question" data-step="2">
                    <h4 class="mb-4 text-center">2. Your ideal Saturday night dinner would be...</h4>
                    <div class="d-flex flex-column gap-3">
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(2, 'social')">
                            <strong>ğŸ‰</strong> A lively group dinner at a trendy hotspot
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(2, 'explorer')">
                            <strong>ğŸ”</strong> Discovering a hidden gem off the beaten path
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(2, 'comfort')">
                            <strong>ğŸ </strong> A cozy night at my favorite local joint
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(2, 'value')">
                            <strong>ğŸ¯</strong> A special occasion meal I've been saving for
                        </button>
                    </div>
                </div>
                
                <!-- Question 3 -->
                <div class="question" data-step="3">
                    <h4 class="mb-4 text-center">3. When you hear about a new restaurant, you...</h4>
                    <div class="d-flex flex-column gap-3">
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(3, 'explorer')">
                            <strong>ğŸš€</strong> Want to be the first to try it!
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(3, 'value')">
                            <strong>ğŸ“Š</strong> Research reviews and wait for a deal
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(3, 'comfort')">
                            <strong>â°</strong> Add to my list but go when I'm in the mood
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(3, 'social')">
                            <strong>ğŸ‘«</strong> Ask friends to go with you first
                        </button>
                    </div>
                </div>
                
                <!-- Question 4 -->
                <div class="question" data-step="4">
                    <h4 class="mb-4 text-center">4. What's your approach to reading a menu?</h4>
                    <div class="d-flex flex-column gap-3">
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(4, 'explorer')">
                            <strong>ğŸ†•</strong> Always try something new and different
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(4, 'value')">
                            <strong>ğŸ’°</strong> Check prices and look for the best deal
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(4, 'comfort')">
                            <strong>ğŸ•</strong> Get my usual favorites
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(4, 'social')">
                            <strong>ğŸ½ï¸</strong> Order a few dishes to share with the table
                        </button>
                    </div>
                </div>
                
                <!-- Question 5 -->
                <div class="question" data-step="5">
                    <h4 class="mb-4 text-center">5. When dining out, you prefer...</h4>
                    <div class="d-flex flex-column gap-3">
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(5, 'social')">
                            <strong>ğŸ’¬</strong> Good conversation and connection
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(5, 'value')">
                            <strong>ğŸ¯</strong> Efficient service, in and out
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(5, 'explorer')">
                            <strong>ğŸ“–</strong> Learning about the food and preparation
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(5, 'comfort')">
                            <strong>ğŸ˜Œ</strong> Relaxed atmosphere, no rush
                        </button>
                    </div>
                </div>
                
                <!-- Question 6 -->
                <div class="question" data-step="6">
                    <h4 class="mb-4 text-center">6. Pick a food-related vacation destination:</h4>
                    <div class="d-flex flex-column gap-3">
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(6, 'explorer')">
                            <strong>ğŸ‡¹ğŸ‡­</strong> Street food tour in Bangkok
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(6, 'value')">
                            <strong>ğŸ‡²ğŸ‡½</strong> All-inclusive resort in Mexico
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(6, 'comfort')">
                            <strong>ğŸ‡®ğŸ‡¹</strong> Cozy Italian trattoria in Rome
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(6, 'social')">
                            <strong>ğŸ‡¯ğŸ‡µ</strong> Teppanyaki in Osaka with a group
                        </button>
                    </div>
                </div>
                
                <!-- Question 7 -->
                <div class="question" data-step="7">
                    <h4 class="mb-4 text-center">7. Finally, what matters most for your perfect meal?</h4>
                    <div class="d-flex flex-column gap-3">
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(7, 'explorer')">
                            <strong>ğŸ¨</strong> Culinary creativity and unique flavors
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(7, 'social')">
                            <strong>â¤ï¸</strong> Sharing great food with great company
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(7, 'value')">
                            <strong>âœ…</strong> Consistent quality at fair prices
                        </button>
                        <button type="button" class="btn btn-outline-secondary p-3 text-start" onclick="selectAnswer(7, 'comfort')">
                            <strong>ğŸ¥°</strong> Feeling happy and satisfied
                        </button>
                    </div>
                </div>
                
                <!-- Results Button -->
                <div class="text-center mt-4">
                    <button type="button" id="resultsBtn" class="btn btn-primary btn-lg" onclick="calculateResult()" style="background: linear-gradient(135deg, #667eea, #764ba2); border: none; display: none;">
                        ğŸ­ See My Personality Type
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Results -->
<section class="py-5" id="results" style="display: none;">
    <div class="container">
        <div class="quiz-card" style="background: white; border-radius: 20px; padding: 50px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); text-align: center;">
            <div id="resultsContent"></div>
        </div>
    </div>
</section>

<script>
const answers = {};

function selectAnswer(question, type) {
    answers[question] = type;
    
    // Update dot
    document.getElementById(`dot${question}`).style.background = '#667eea';
    document.getElementById(`dot${question}`).style.transform = 'scale(1.3)';
    
    // Visual feedback
    event.target.closest('.d-flex').querySelectorAll('button').forEach(btn => {
        btn.style.borderColor = '#e9ecef';
        btn.style.background = 'transparent';
        btn.style.color = '#333';
    });
    event.target.closest('button').style.borderColor = '#667eea';
    event.target.closest('button').style.background = '#667eea';
    event.target.closest('button').style.color = 'white';
    
    setTimeout(() => {
        if (question < 7) {
            showQuestion(question + 1);
        } else {
            document.getElementById('resultsBtn').style.display = 'inline-block';
            document.getElementById('resultsBtn').scrollIntoView({ behavior: 'smooth' });
        }
    }, 400);
}

function showQuestion(step) {
    document.querySelectorAll('.question').forEach(q => q.classList.remove('active'));
    document.querySelector(`[data-step="${step}"]`).classList.add('active');
    document.querySelector(`[data-step="${step}"]`).scrollIntoView({ behavior: 'smooth' });
}

function calculateResult() {
    const counts = { explorer: 0, comfort: 0, social: 0, value: 0 };
    Object.values(answers).forEach(type => counts[type]++);
    
    const types = {
        explorer: { name: 'Foodie Explorer', icon: 'ğŸŒ', desc: 'You love discovering new cuisines and unique dining experiences. Your perfect restaurants are trendy, innovative, and offer creative menus.' },
        comfort: { name: 'Comfort Seeker', icon: 'ğŸœ', desc: 'You appreciate reliable favorites and cozy atmospheres. Your perfect restaurants are warm, welcoming, and serve your go-to dishes.' },
        social: { name: 'Social Butterfly', icon: 'ğŸ‘¥', desc: 'You dine for the experience and company. Your perfect restaurants are lively, group-friendly, and have great atmospheres.' },
        value: { name: 'Smart Shopper', icon: 'ğŸ’', desc: 'You want quality at fair prices. Your perfect restaurants offer great value, consistent quality, and worthwhile experiences.' }
    };
    
    const winner = Object.entries(counts).sort((a, b) => b[1] - a[1])[0][0];
    const result = types[winner];
    
    document.getElementById('results').style.display = 'block';
    document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
    document.getElementById('resultsContent').innerHTML = `
        <span style="font-size: 5rem;">${result.icon}</span>
        <h2 class="mt-3">You're a ${result.name}!</h2>
        <p class="lead mt-3">${result.desc}</p>
        <div class="mt-4">
            <a href="/search" class="btn btn-primary btn-lg me-2" style="background: #d32323;">Find Restaurants</a>
            <a href="/quiz/perfect-spot" class="btn btn-outline-secondary btn-lg">Take Another Quiz</a>
        </div>
    `;
}
</script>
{% endblock %}
