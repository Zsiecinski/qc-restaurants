{% extends "base.html" %}

{% block title %}üçú Food Tour Builder - Quezon City{% endblock %}

{% block content %}
<!-- Hero -->
<section class="tour-hero" style="background: linear-gradient(135deg, #d32323 0%, #ff6b6b 100%); color: white; padding: 80px 0; text-align: center;">
    <div class="container">
        <h1 class="display-4 fw-bold mb-3">üçú Build Your Food Tour</h1>
        <p class="lead">Create the perfect dining itinerary in Quezon City</p>
    </div>
</section>

<!-- Tour Builder Form -->
<section style="position: relative; z-index: 10;">
    <div class="container">
        <div class="tour-form-card" style="background: white; border-radius: 20px; padding: 40px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); margin-top: -40px;">
            <form id="tourForm">
                <div class="row g-4">
                    <div class="col-md-4">
                        <label class="form-label">Cuisine Type</label>
                        <select name="cuisine" class="form-select form-select-lg">
                            <option value="">Any Cuisine</option>
                            {%_cuisines %}
 for c in all                            <option value="{{ c }}">{{ c }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Area</label>
                        <select name="area" class="form-select form-select-lg">
                            <option value="">Any Area</option>
                            {% for a in areas %}
                            <option value="{{ a }}">{{ a }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Stops</label>
                        <select name="stops" class="form-select form-select-lg">
                            <option value="3">3 Stops</option>
                            <option value="4">4 Stops</option>
                            <option value="5" selected>5 Stops</option>
                            <option value="6">6 Stops</option>
                        </select>
                    </div>
                </div>
                <button type="button" onclick="generateTour()" class="btn btn-primary btn-lg w-100 mt-4" style="background: #d32323; border: none;">
                    <i class="fas fa-magic"></i> Generate My Food Tour
                </button>
            </form>
        </div>
    </div>
</section>

<!-- Tour Results -->
<section class="py-5" id="tourResults" style="display: none;">
    <div class="container">
        <h2 class="text-center mb-5">üçΩÔ∏è Your Custom Food Tour</h2>
        <div id="tourStops"></div>
        
        <div class="text-center mt-4">
            <button onclick="window.print()" class="btn btn-outline-secondary">
                <i class="fas fa-print"></i> Print Tour
            </button>
            <button onclick="regenerateTour()" class="btn btn-primary" style="background: #d32323;">
                <i class="fas fa-redo"></i> Generate Different Tour
            </button>
        </div>
    </div>
</section>

<!-- Sample Tours -->
<section class="py-5 bg-light">
    <div class="container">
        <h3 class="mb-4">üéØ Popular Tour Themes</h3>
        <div class="row g-4">
            <div class="col-md-4">
                <a href="/food-tour?cuisine=Filipino&stops=5" class="text-decoration-none">
                    <div class="p-4 bg-white rounded" style="box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                        <span style="font-size: 2rem;">üáµüá≠</span>
                        <h5 class="mt-2">Filipino Food Trail</h5>
                        <p class="text-muted">Experience the best of Filipino cuisine</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4">
                <a href="/food-tour?cuisine=Cafe&stops=4" class="text-decoration-none">
                    <div class="p-4 bg-white rounded" style="box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                        <span style="font-size: 2rem;">‚òï</span>
                        <h5 class="mt-2">Coffee & Dessert Tour</h5>
                        <p class="text-muted">Sweet spots across Quezon City</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4">
                <a href="/food-tour?area=Timog&stops=5" class="text-decoration-none">
                    <div class="p-4 bg-white rounded" style="box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                        <span style="font-size: 2rem;">üó∫Ô∏è</span>
                        <h5 class="mt-2">Timog Food Walk</h5>
                        <p class="text-muted">Explore Timog's culinary gems</p>
                    </div>
                </a>
            </div>
        </div>
    </div>
</section>

<script>
let tourData = {{ tour_data|tojson if tour_data else 'null' }};

function generateTour() {
    const form = document.getElementById('tourForm');
    const params = new URLSearchParams(new FormData(form)).toString();
    window.location.href = '/food-tour?' + params;
}

function regenerateTour() {
    generateTour();
}

{% if tour_data %}
document.getElementById('tourResults').style.display = 'block';
let stopsHtml = '';
tourData.forEach((stop, index) => {
    stopsHtml += `
        <div class="tour-stop" style="background: white; border-radius: 16px; padding: 30px; margin-bottom: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); position: relative; overflow: hidden;">
            <div class="stop-number" style="position: absolute; top: 20px; right: 20px; background: #d32323; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">${index + 1}</div>
            <div class="row">
                <div class="col-md-3">
                    ${stop.photo ? `<img src="${stop.photo}" alt="${stop.name}" style="width: 100%; border-radius: 12px;">` : '<div style="width: 100%; height: 150px; background: #f8f9fa; border-radius: 12px; display: flex; align-items: center; justify-content: center;"><span style="font-size: 3rem;">üçΩÔ∏è</span></div>'}
                </div>
                <div class="col-md-9">
                    <h4>${stop.name}</h4>
                    <p class="text-muted">
                        <i class="fas fa-tag"></i> ${stop.cuisine} ‚Ä¢ 
                        <i class="fas fa-map-marker-alt"></i> ${stop.area}
                    </p>
                    ${stop.rating ? `<span class="badge bg-warning text-dark">‚≠ê ${stop.rating}</span>` : ''}
                    ${stop.price_range ? `<span class="badge bg-secondary">${stop.price_range}</span>` : ''}
                    <p class="mt-2">${stop.about || ''}</p>
                    <a href="/restaurant/${stop.slug}" class="btn btn-outline-primary btn-sm">View Details</a>
                </div>
            </div>
        </div>
    `;
});
document.getElementById('tourStops').innerHTML = stopsHtml;
{% endif %}
</script>
{% endblock %}
