<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Saved Restaurants - Restaurants Quezon City</title>
    <meta name="description" content="Your saved restaurants in Quezon City. Quick access to your favorite dining spots.">
    <link rel="canonical" href="/saved">
    
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/fontawesome.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.min.css') }}">
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
        }
        .hero {
            background: linear-gradient(135deg, #d32323, #ff6b6b);
            color: white;
            padding: 60px 0;
            text-align: center;
        }
        .saved-count {
            font-size: 3rem;
            font-weight: 700;
        }
        .restaurant-card {
            border: none;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .saved-badge {
            background: #d32323;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
        }
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }
        .empty-state i {
            font-size: 64px;
            color: #ddd;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <div class="logo-circle me-2">
                    <i class="fas fa-utensils text-danger"></i>
                </div>
                <div class="brand-text">
                    <div class="brand-main">RESTAURANTS</div>
                    <div class="brand-sub">QUEZON CITY</div>
                </div>
            </a>
            <a href="/" class="btn btn-outline-dark btn-sm">Back to Home</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1 class="display-4 fw-bold mb-3">❤️ My Saved Restaurants</h1>
            <p class="lead">Quick access to your favorite dining spots</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container my-5">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                
                <!-- Stats -->
                <div class="text-center mb-4">
                    <span class="saved-count" id="savedCount">0</span>
                    <p class="text-muted">Restaurants saved</p>
                </div>

                <!-- Saved Restaurants List -->
                <div id="savedRestaurantsList">
                    <!-- Populated by JavaScript -->
                </div>

                <!-- Empty State (shown when no saved restaurants) -->
                <div class="empty-state" id="emptyState" style="display: none;">
                    <i class="far fa-heart"></i>
                    <h3 class="h4 mb-3">No Saved Restaurants Yet</h3>
                    <p class="text-muted mb-4">
                        Start exploring Quezon City's best restaurants and save your favorites for quick access!
                    </p>
                    <a href="/" class="btn btn-danger btn-lg">
                        Browse Restaurants
                    </a>
                </div>

                <!-- Clear All Button -->
                <div class="text-center mt-4" id="clearAllBtn" style="display: none;">
                    <button class="btn btn-outline-secondary" onclick="clearAllSaved()">
                        <i class="fas fa-trash me-2"></i> Clear All Saved
                    </button>
                </div>

            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer py-4" style="background-color: #000;">
        <div class="container text-center">
            <p class="text-white-50 mb-2">© 2026 RestaurantsQuezonCity.com. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Load saved restaurants
        function loadSavedRestaurants() {
            const saved = JSON.parse(localStorage.getItem('savedRestaurants') || '[]');
            const container = document.getElementById('savedRestaurantsList');
            const emptyState = document.getElementById('emptyState');
            const clearBtn = document.getElementById('clearAllBtn');
            const countEl = document.getElementById('savedCount');
            
            countEl.textContent = saved.length;
            
            if (saved.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                clearBtn.style.display = 'none';
                return;
            }
            
            emptyState.style.display = 'none';
            clearBtn.style.display = saved.length > 0 ? 'block' : 'none';
            
            let html = '';
            saved.forEach((restaurant, index) => {
                const link = `/restaurant/${restaurant.id}`; // This would need proper slug
                html += `
                    <article class="restaurant-card card">
                        <div class="card-body p-4">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <span class="saved-badge mb-2 d-inline-block">❤️ Saved</span>
                                    <h3 class="h5 mb-1">${escapeHtml(restaurant.name)}</h3>
                                    <p class="text-muted mb-2">
                                        <i class="fas fa-map-marker-alt me-2"></i>${escapeHtml(restaurant.area || 'Quezon City')}
                                    </p>
                                    <span class="cuisine-badge">${escapeHtml(restaurant.cuisine || 'Restaurant')}</span>
                                </div>
                                <button class="btn btn-outline-danger btn-sm" onclick="removeSaved(${index})">
                                    <i class="fas fa-times"></i> Remove
                                </button>
                            </div>
                            <div class="mt-3">
                                <a href="${link}" class="btn btn-danger btn-sm">View Details</a>
                            </div>
                        </div>
                    </article>
                `;
            });
            
            container.innerHTML = html;
        }

        // Remove a saved restaurant
        function removeSaved(index) {
            const saved = JSON.parse(localStorage.getItem('savedRestaurants') || '[]');
            saved.splice(index, 1);
            localStorage.setItem('savedRestaurants', JSON.stringify(saved));
            loadSavedRestaurants();
            
            // Show toast notification
            showToast('Restaurant removed from saved list');
        }

        // Clear all saved
        function clearAllSaved() {
            if (confirm('Are you sure you want to remove all saved restaurants?')) {
                localStorage.removeItem('savedRestaurants');
                loadSavedRestaurants();
                showToast('All saved restaurants cleared');
            }
        }

        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text || '';
            return div.innerHTML;
        }

        // Simple toast notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast-container position-fixed bottom-0 end-0 p-3';
            toast.innerHTML = `
                <div class="toast show" role="alert">
                    <div class="toast-header bg-danger text-white">
                        <strong class="me-auto">Restaurants QC</strong>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
                    </div>
                    <div class="toast-body">${message}</div>
                </div>
            `;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', loadSavedRestaurants);
    </script>
</body>
</html>
