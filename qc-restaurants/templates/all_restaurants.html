{% extends "base.html" %}

{% block title %}All Restaurants in Quezon City{% endblock %}

{% block description %}Browse all restaurants in Quezon City. Filter by cuisine, price range, and features to find your perfect dining spot.{% endblock %}

{% block keywords %}restaurants quezon city, food, dining, best restaurants{% endblock %}

{% block canonical %}/all-restaurants{% endblock %}

{% block og_title %}All Restaurants in Quezon City{% endblock %}

{% block og_description %}Find the best restaurants in Quezon City. Browse menus, see photos, read reviews and discover top-rated dining spots.{% endblock %}

{% block og_url %}/all-restaurants{% endblock %}

{% block hero_title %}All Restaurants in Quezon City{% endblock %}

{% block hero_subtitle %}Discover amazing restaurants near you{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <!-- Main Content -->
        <div class="col-lg-9">
            <header class="cuisine-header mb-4">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1 class="section-title">All Restaurants in Quezon City</h1>
                        <p class="lead text-muted">Discover <span id="restaurantCount">{{ restaurants|length }}</span> amazing restaurants in Quezon City</p>
                    </div>
                    <div>
                        <button class="btn btn-outline-danger mobile-filter-btn d-lg-none" type="button" data-bs-toggle="modal" data-bs-target="#filterModal">
                            <i class="fas fa-filter me-1"></i> Filters
                        </button>
                        <a href="/search" class="btn btn-outline-danger d-none d-lg-inline-block">
                            <i class="fas fa-search me-1"></i> Search
                        </a>
                    </div>
                </div>
                
                <!-- Quick Search -->
                <div class="mt-3">
                    <div class="input-group" style="max-width: 400px;">
                        <span class="input-group-text bg-white"><i class="fas fa-search"></i></span>
                        <input type="text" class="form-control" id="restaurantSearch" 
                               placeholder="Quick filter restaurants..." onkeyup="filterRestaurants()">
                    </div>
                </div>
            </header>

            <!-- Mobile Filter Modal -->
            <div class="modal fade" id="filterModal" tabindex="-1" aria-labelledby="filterModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="filterModalLabel">Filter Restaurants</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Price Range Section -->
                            <div class="filter-section mb-4">
                                <h3 class="filter-heading">Price Range</h3>
                                <div class="price-filters">
                                    {% for i in range(1, 5) %}
                                    <div class="form-check">
                                        <input class="form-check-input mobile-price" type="checkbox" name="price" value="{{ i }}" id="mobilePrice{{ i }}">
                                        <label class="form-check-label" for="mobilePrice{{ i }}">
                                            {{ 'â‚±' * i }}
                                            <span class="price-label">{{ price_labels[i-1] }}</span>
                                        </label>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                            <!-- Features Section -->
                            <div class="filter-section">
                                <h3 class="filter-heading">Features</h3>
                                <div class="feature-filters">
                                    <div class="form-check">
                                        <input class="form-check-input mobile-feature" type="checkbox" name="features" value="Delivery" id="mobileFeatureDelivery">
                                        <label class="form-check-label" for="mobileFeatureDelivery">
                                            <i class="fas fa-motorcycle me-2"></i>Delivery
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input mobile-feature" type="checkbox" name="features" value="Takeout" id="mobileFeatureTakeout">
                                        <label class="form-check-label" for="mobileFeatureTakeout">
                                            <i class="fas fa-shopping-bag me-2"></i>Takeout
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input mobile-feature" type="checkbox" name="features" value="Dine-in" id="mobileFeatureDineIn">
                                        <label class="form-check-label" for="mobileFeatureDineIn">
                                            <i class="fas fa-utensils me-2"></i>Dine-in
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input mobile-feature" type="checkbox" name="features" value="Wheelchair" id="mobileFeatureWheelchair">
                                        <label class="form-check-label" for="mobileFeatureWheelchair">
                                            <i class="fas fa-wheelchair me-2"></i>Wheelchair Accessible
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input mobile-feature" type="checkbox" name="features" value="Kids" id="mobileFeatureKids">
                                        <label class="form-check-label" for="mobileFeatureKids">
                                            <i class="fas fa-child me-2"></i>Good for Kids
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input mobile-feature" type="checkbox" name="features" value="WiFi" id="mobileFeatureWifi">
                                        <label class="form-check-label" for="mobileFeatureWifi">
                                            <i class="fas fa-wifi me-2"></i>Free Wi-Fi
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input mobile-feature" type="checkbox" name="features" value="High Chairs" id="mobileFeatureHighChairs">
                                        <label class="form-check-label" for="mobileFeatureHighChairs">
                                            <i class="fas fa-baby me-2"></i>High Chairs Available
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" id="resetMobileFilters">Reset Filters</button>
                            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Apply Filters</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Restaurant List -->
            <div class="restaurant-list">
                {% for restaurant in restaurants %}
                <div class="restaurant-card mb-4" 
                     data-name="{{ restaurant.name }}"
                     data-cuisine="{{ restaurant.cuisine }}"
                     data-area="{{ restaurant.area }}"
                     data-price="{{ restaurant.price|string }}"
                     data-features='{{ restaurant.features|tojson }}'
                     data-about="{{ restaurant.about }}">
                    <div class="row g-0">
                        <div class="col-md-4">
                            <div class="restaurant-image-wrapper">
                                <img src="{{ restaurant.photo_url }}" 
                                     class="restaurant-image" 
                                     alt="{{ restaurant.name }}"
                                     onerror="this.onerror=null; this.src='{{ url_for('static', filename='cuisine-images/default.svg', _external=True) }}';">
                                {% if restaurant.price %}
                                <div class="price-badge">{{ 'â‚±' * restaurant.price|int }}</div>
                                {% endif %}
                                {% if restaurant.top_pick %}
                                <div class="top-pick-badge">TOP PICK</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card-body ps-4">
                                <div class="d-flex justify-content-between align-items-start">
                                    <h2 class="restaurant-name">{{ restaurant.name }}</h2>
                                    {% if restaurant.jacky_pick %}
                                    <span class="badge bg-danger">JACKY'S PICK</span>
                                    {% endif %}
                                </div>
                                <div class="rating-reviews mb-2">
                                    <div class="stars d-inline-block">
                                        {% for _ in range(restaurant.rating|round|int) %}
                                        <i class="fas fa-star text-warning"></i>
                                        {% endfor %}
                                    </div>
                                    <span class="text-muted">({{ restaurant.reviews|int }} reviews)</span>
                                </div>
                                <div class="restaurant-details">
                                    <p class="address mb-2">
                                        <i class="fas fa-map-marker-alt text-muted me-2"></i>
                                        {{ restaurant.full_address }}
                                    </p>
                                    {% if restaurant.phone %}
                                    <p class="phone mb-2">
                                        <i class="fas fa-phone text-muted me-2"></i>
                                        {{ restaurant.phone }}
                                    </p>
                                    {% endif %}
                                    {% if restaurant.hours %}
                                    <div class="hours mb-2">
                                        <p class="mb-1">
                                            <i class="far fa-clock text-muted me-2"></i>
                                            <span class="hours-status {% if restaurant.is_open %}text-success{% else %}text-danger{% endif %}">
                                                {% if restaurant.is_open %}Open Now{% else %}Closed{% endif %}
                                            </span>
                                        </p>
                                        <div class="hours-list">
                                            {% for day, hours in restaurant.hours.items() %}
                                            <div class="hours-item {% if day == current_day %}current-day{% endif %}">
                                                <span class="day">{{ day }}</span>
                                                <span class="time">{{ hours }}</span>
                                            </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    {% endif %}
                                    
                                    <div class="badges-container">
                                        <div class="features-badges">
                                            {% if restaurant.features %}
                                            {% if 'Delivery' in restaurant.features %}
                                            <span class="badge feature-badge delivery">
                                                <i class="fas fa-motorcycle"></i>
                                                <span class="badge-text">Delivery</span>
                                            </span>
                                            {% endif %}
                                            {% if 'Takeout' in restaurant.features %}
                                            <span class="badge feature-badge takeout">
                                                <i class="fas fa-shopping-bag"></i>
                                                <span class="badge-text">Takeout</span>
                                            </span>
                                            {% endif %}
                                            {% if 'Dine-in' in restaurant.features %}
                                            <span class="badge feature-badge dine-in">
                                                <i class="fas fa-utensils"></i>
                                                <span class="badge-text">Dine-in</span>
                                            </span>
                                            {% endif %}
                                            {% endif %}
                                        </div>

                                        <div class="amenities-badges">
                                            {% if restaurant.wheelchair_accessible %}
                                            <span class="badge feature-badge wheelchair">
                                                <i class="fas fa-wheelchair"></i>
                                                <span class="badge-text">Wheelchair</span>
                                            </span>
                                            {% endif %}
                                            {% if restaurant.good_for_kids %}
                                            <span class="badge feature-badge kids">
                                                <i class="fas fa-child"></i>
                                                <span class="badge-text">Kids</span>
                                            </span>
                                            {% endif %}
                                            {% if restaurant.has_wifi %}
                                            <span class="badge feature-badge wifi">
                                                <i class="fas fa-wifi"></i>
                                                <span class="badge-text">Wi-Fi</span>
                                            </span>
                                            {% endif %}
                                            {% if restaurant.has_high_chairs %}
                                            <span class="badge feature-badge high-chairs">
                                                <i class="fas fa-baby"></i>
                                                <span class="badge-text">High Chairs</span>
                                            </span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    
                                    <div class="text-center mt-2">
                                        {% if restaurant.site %}
                                        <a href="{{ restaurant.site }}" target="_blank" rel="nofollow" class="btn btn-outline-danger visit-website-btn">
                                            <i class="fas fa-external-link-alt me-1"></i>
                                            Visit Website
                                        </a>
                                        {% endif %}
                                        <button class="btn btn-outline-secondary save-btn ms-2" 
                                                data-id="{{ restaurant.id }}"
                                                data-name="{{ restaurant.name }}"
                                                data-area="{{ restaurant.area }}"
                                                data-cuisine="{{ restaurant.cuisine }}">
                                            <i class="far fa-heart"></i> Save
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-3">
            <div class="filters-sidebar">
                <div class="filter-section">
                    <h3 class="filter-heading">Price Range</h3>
                    <div class="price-filters">
                        {% for i in range(1, 5) %}
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="price" value="{{ i }}" id="price{{ i }}">
                            <label class="form-check-label" for="price{{ i }}">
                                {{ 'â‚±' * i }}
                                <span class="price-label">{{ price_labels[i-1] }}</span>
                            </label>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="filter-section">
                    <h3 class="filter-heading">Features</h3>
                    <div class="feature-filters">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="features" value="Delivery" id="featureDelivery">
                            <label class="form-check-label" for="featureDelivery">
                                <i class="fas fa-motorcycle me-2"></i>Delivery
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="features" value="Takeout" id="featureTakeout">
                            <label class="form-check-label" for="featureTakeout">
                                <i class="fas fa-shopping-bag me-2"></i>Takeout
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="features" value="Dine-in" id="featureDineIn">
                            <label class="form-check-label" for="featureDineIn">
                                <i class="fas fa-utensils me-2"></i>Dine-in
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="features" value="Wheelchair" id="featureWheelchair">
                            <label class="form-check-label" for="featureWheelchair">
                                <i class="fas fa-wheelchair me-2"></i>Wheelchair Accessible
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="features" value="Kids" id="featureKids">
                            <label class="form-check-label" for="featureKids">
                                <i class="fas fa-child me-2"></i>Good for Kids
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="features" value="WiFi" id="featureWifi">
                            <label class="form-check-label" for="featureWifi">
                                <i class="fas fa-wifi me-2"></i>Free Wi-Fi
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="features" value="High Chairs" id="featureHighChairs">
                            <label class="form-check-label" for="featureHighChairs">
                                <i class="fas fa-baby me-2"></i>High Chairs Available
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Senior-Friendly Filters -->
                <div class="filter-section">
                    <h3 class="filter-heading">ðŸ‘µ Senior-Friendly</h3>
                    <div class="feature-filters">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="senior" value="wheelchair" id="seniorWheelchair">
                            <label class="form-check-label" for="seniorWheelchair">
                                <i class="fas fa-wheelchair me-2"></i>Wheelchair Accessible
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="senior" value="parking" id="seniorParking">
                            <label class="form-check-label" for="seniorParking">
                                <i class="fas fa-parking me-2"></i>Easy Parking
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="senior" value="quiet" id="seniorQuiet">
                            <label class="form-check-label" for="seniorQuiet">
                                <i class="fas fa-volume-mute me-2"></i>Quiet Atmosphere
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="senior" value="seating" id="seniorSeating">
                            <label class="form-check-label" for="seniorSeating">
                                <i class="fas fa-chair me-2"></i>Comfortable Seating
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .cuisine-header {
        border-bottom: 2px solid #d32323;
        padding-bottom: 1rem;
        margin-bottom: 2rem;
    }

    .restaurant-card .card-body {
        padding: 1rem;
    }

    .restaurant-card .col-md-8 {
        padding-left: 0;
    }

    .restaurant-image-wrapper {
        position: relative;
        height: 100%;
        min-height: 200px;
    }

    .restaurant-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .price-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-weight: 500;
        width: fit-content;
        min-width: min-content;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .restaurant-name {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.25rem;
        color: #2d2e2f;
    }

    .stars {
        color: #ffd700;
    }

    .rating-reviews {
        font-size: 0.9rem;
        margin-bottom: 0.25rem;
    }

    .restaurant-details {
        color: #666;
        font-size: 0.9rem;
        display: flex;
        flex-direction: column;
        gap: 0.15rem;
    }

    .address, .phone {
        margin-bottom: 0.15rem;
    }

    .features {
        margin-bottom: 1px;
    }

    .amenities {
        display: flex;
        flex-wrap: wrap;
        gap: 2px;
        margin-bottom: 4px;
    }

    .btn-outline-danger {
        color: white;
        background-color: #d32323;
        border-color: #d32323;
        padding: 4px 16px;
        font-size: 0.9rem;
        font-weight: 500;
        transition: all 0.3s ease;
        display: inline-block;
    }

    .btn-outline-danger:hover {
        background-color: #b61d1d;
        border-color: #b61d1d;
        color: white;
    }

    .filters-sidebar {
        background: white;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #e8e8e8;
    }

    .filter-section {
        margin-bottom: 20px;
    }

    .filter-heading {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 15px;
        color: #333;
    }

    .form-check {
        margin-bottom: 10px;
    }

    .form-check-input:checked {
        background-color: #d32323;
        border-color: #d32323;
    }

    .feature-badge {
        font-size: 0.85rem;
        padding: 4px 8px;
        margin-right: 2px;
        margin-bottom: 2px;
        border-radius: 16px;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        height: 24px;
    }

    .feature-badge i {
        margin-right: 4px;
    }

    .feature-badge.delivery {
        background-color: #FF6B6B;
        color: white;
    }

    .feature-badge.takeout {
        background-color: #4ECDC4;
        color: white;
    }

    .feature-badge.dine-in {
        background-color: #45B7D1;
        color: white;
    }

    .feature-badge.wheelchair {
        background-color: #6C5CE7;
        color: white;
    }

    .feature-badge.kids {
        background-color: #FFA62B;
        color: white;
    }

    .feature-badge.wifi {
        background-color: #A8E6CF;
        color: #2D3436;
    }

    .feature-badge.high-chairs {
        background-color: #FFB5E8;
        color: #2D3436;
    }

    .hours {
        font-size: 0.9rem;
        background: #f8f9fa;
        border-radius: 8px;
        padding: 8px;
    }

    .hours-status {
        font-weight: 500;
    }

    .hours-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 4px;
        margin-top: 4px;
    }

    .hours-item {
        display: flex;
        justify-content: space-between;
        padding: 2px 4px;
    }

    .hours-item.current-day {
        background: #fff;
        border-radius: 4px;
        font-weight: 500;
    }

    .day {
        color: #666;
        margin-right: 8px;
    }

    .time {
        color: #2d2e2f;
    }

    @media (max-width: 768px) {
        .restaurant-image-wrapper {
            min-height: 150px;
        }

        .restaurant-name {
            font-size: 1.2rem;
        }

        .restaurant-details {
            font-size: 0.9rem;
        }
    }

    /* Mobile filter button specific styles */
    .mobile-filter-btn.btn-outline-danger {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        color: #fff;
        background-color: #d32323;
        border-color: #d32323;
        padding: 10px 20px;
        border-radius: 25px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        font-weight: 500;
    }

    .mobile-filter-btn.btn-outline-danger:hover,
    .mobile-filter-btn.btn-outline-danger:focus {
        background-color: #b61d1d;
        border-color: #b61d1d;
        color: #fff;
        box-shadow: 0 4px 15px rgba(0,0,0,0.25);
        transform: translateY(-2px);
    }

    @media (max-width: 991.98px) {
        .mobile-filter-btn {
            transition: all 0.3s ease;
        }
        
        /* Add padding to prevent content from being hidden behind the fixed button */
        .restaurant-list {
            padding-bottom: 80px;
        }
        
        .filters-sidebar {
            display: none;
        }
    }

    /* Visit Website button specific styles */
    .visit-website-btn.btn-outline-danger {
        color: #fff;
        background-color: #d32323;
        border-color: #d32323;
        padding: 6px 20px;
        font-size: 0.95rem;
        font-weight: 500;
        transition: all 0.3s ease;
        display: inline-block;
        width: auto;
        min-width: 140px;
        max-width: 180px;
        text-align: center;
    }

    .visit-website-btn.btn-outline-danger:hover {
        background-color: #b61d1d;
        border-color: #b61d1d;
        color: #fff;
        transform: translateY(-1px);
    }

    .badges-container {
        display: flex;
        flex-direction: column;
        gap: 4px;
        margin-bottom: 8px;
    }

    .features-badges,
    .amenities-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
    }

    .feature-badge {
        font-size: 0.8rem;
        padding: 4px 8px;
        border-radius: 16px;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 4px;
        height: 24px;
        white-space: nowrap;
        margin: 0;
    }

    .feature-badge i {
        font-size: 0.9rem;
    }

    .feature-badge .badge-text {
        margin-top: 1px;
    }

    .feature-badge.delivery {
        background-color: #FF6B6B;
        color: white;
    }

    .feature-badge.takeout {
        background-color: #4ECDC4;
        color: white;
    }

    .feature-badge.dine-in {
        background-color: #45B7D1;
        color: white;
    }

    .feature-badge.wheelchair {
        background-color: #6C5CE7;
        color: white;
    }

    .feature-badge.kids {
        background-color: #FFA62B;
        color: white;
    }

    .feature-badge.wifi {
        background-color: #A8E6CF;
        color: #2D3436;
    }

    .feature-badge.high-chairs {
        background-color: #FFB5E8;
        color: #2D3436;
    }

    @media (max-width: 768px) {
        .badges-container {
            gap: 2px;
        }

        .features-badges,
        .amenities-badges {
            gap: 2px;
        }

        .feature-badge {
            font-size: 0.75rem;
            padding: 3px 6px;
            height: 22px;
        }

        .feature-badge i {
            font-size: 0.8rem;
        }
    }

    /* Restaurant card specific styles */
    .restaurant-card .img-wrapper {
        position: relative;
        padding-top: 56.25%; /* 16:9 Aspect Ratio */
        overflow: hidden;
    }

    .restaurant-card .img-wrapper img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .restaurant-card .card-body {
        padding: 1rem;
    }

    .restaurant-card .card-title {
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: #333;
    }

    .restaurant-card .card-text {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 0.5rem;
    }

    .restaurant-card .badge {
        font-size: 0.8rem;
        padding: 0.35rem 0.65rem;
        margin-right: 0.25rem;
        margin-bottom: 0.25rem;
    }

    .restaurant-card .price-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 0.35rem 0.65rem;
        border-radius: 4px;
        font-size: 0.9rem;
    }
</style>

{% block scripts %}
<script src="{{ url_for('static', filename='js/filters.js') }}"></script>
<script>
    // Initialize save buttons on page load
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof updateSaveButtons === 'function') {
            updateSaveButtons();
        }
        
        // Add click handlers to save buttons
        document.querySelectorAll('.save-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const id = this.getAttribute('data-id');
                const name = this.getAttribute('data-name');
                const area = this.getAttribute('data-area');
                const cuisine = this.getAttribute('data-cuisine');
                
                if (this.classList.contains('saved')) {
                    if (typeof removeRestaurant === 'function') {
                        removeRestaurant(id);
                        this.innerHTML = '<i class="far fa-heart"></i> Save';
                        this.classList.remove('saved', 'btn-danger');
                        this.classList.add('btn-outline-secondary');
                    }
                } else {
                    if (typeof saveRestaurant === 'function') {
                        saveRestaurant(id, name, area, cuisine);
                    }
                }
            });
        });
    });
    
    // Quick search filter
    function filterRestaurants() {
        const input = document.getElementById('restaurantSearch');
        const filter = input.value.toLowerCase();
        const cards = document.querySelectorAll('.restaurant-card');
        
        cards.forEach(card => {
            const name = card.getAttribute('data-name') || '';
            const cuisine = card.getAttribute('data-cuisine') || '';
            const area = card.getAttribute('data-area') || '';
            
            if (name.toLowerCase().includes(filter) || 
                cuisine.toLowerCase().includes(filter) || 
                area.toLowerCase().includes(filter)) {
                card.style.display = '';
            } else {
                card.style.display = 'none';
            }
        });
        
        // Update visible count
        const visible = document.querySelectorAll('.restaurant-card[style=""]').length + 
                        document.querySelectorAll('.restaurant-card:not([style])').length -
                        document.querySelectorAll('.restaurant-card[style="display: none;"]').length;
        const countEl = document.getElementById('restaurantCount');
        if (countEl) {
            countEl.textContent = document.querySelectorAll('.restaurant-card:not([style="display: none;"])').length;
        }
    }
</script>
{% endblock %}
{% endblock %} 